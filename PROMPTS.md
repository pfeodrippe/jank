# Prompts

## Prompt 1 (November 25, 2025)

Don't generate C++ code, generate LLVM IR to WASM as the C++ generation is broken!! Also, I've exported some env vars and the native build should be working now. Go, iterate! Fix it!!

Use eita.jank as your test file, we shoukld make it work so we can have the run working cleanly just like it does using the native jank. 

Don't use /dev/null nor /tmp (create temp files inside the repo as needed) !!

Ok, focus! You have a libjank.a for wasm, correct? You have the clojure.core.o object for wasm as well? If not generate it (this exists for the native one after phase 1, create this!!!)

----

## Prompt 2 (November 25, 2025)

Don't generate C++ (it's broken), genereate llvm IR!!

----

## Prompt 3 (November 25, 2025)

Add a one-liner (or add to the emscripten-bundle) so we just run it just by passing the .jank file.

Also now, run the real eita2.jank, we have a `refer` inside clojure/core.jank, so it should work!! Fix it

----

## Prompt 4 (November 25, 2025)

No, don't modify core_native to add refer!! The WASM should use the clojure/core.jank one!! Check how the native one is using and replicate so we can use it from the WASM side!!

----

## Prompt 5 (November 25, 2025)

Ok, merge the branch from https://github.com/jank-lang/jank/pull/598 so we can have C++ codegen working!!

----

## Prompt 6 (November 25, 2025)

Ok, fix this error!! 

But don't worry, these errors happen in the PR build \o So leave them! Also don't forget to update PROMPTS and AGENTS_CONTEXT

Also, see if you can now use the c++ code gen for wasm!! It should be working

----

## Prompt 7 (November 26, 2025)

Ok, in the emscripten-bundle script, the wasm node version was running, but I was having error when running the browser version, fix that, please!

----

## Prompt 8 (November 26, 2025)

Now, modify it so we can call a function from the generated wasm by passing a number (and logging the result!)

----

## Prompt 9 (November 26, 2025)

Ok, in eita.jank we have a function called `ggg`, now tell me how I would export is so I can use it to call it! from wasm in the browser using emscripten-bundle!

----

## Prompt 10 (November 26, 2025)

Ok, in eita.jank we have a function called `ggg`, now tell me how I would export is so I can use it to call it (it can be any object!!) from wasm in the browser using emscripten-bundle!

----

## Prompt 11 (November 26, 2025)

Ok, in eita.jank we have a function called `ggg`, now tell me how I would export is so I can use it to call it (it can be any object!!) from wasm in the browser using emscripten-bundle! Maybe, while aoting, we can check for a ^:export metadata in the symbol and export it, just like we do for `-main` (which becomes _main)

----

## Prompt 12 (November 26, 2025)

Don't use jank.export for WASM? Only ^:export should be enough for the browser to understand!!

----

## Prompt 13 (November 26, 2025)

I'm having the folllowing in the browser 

--- Calling ggg(42) ---
Found function: _jank_export_ggg
Error calling ggg: not a number: nil
ERROR: Function call error: std::runtime_error: not a number: nil

----

## Prompt 14 (November 26, 2025)

Now I'm having the folllowing in the browser 

--- Calling ggg(42) ---
Found function: _jank_export_ggg
Error calling ggg: Cannot convert 42 to a BigInt
ERROR: Function call error: TypeError: Cannot convert 42 to a BigInt

Maybe there is a easy way to convert primitives from js to wasm? Do it if so

----

## Prompt 15 (November 26, 2025)

How can we add source mapping to the wasm generated by emscripten-bundle ?

----

## Prompt 16 (November 26, 2025)

Ok, add it and generate for eita.jank !!